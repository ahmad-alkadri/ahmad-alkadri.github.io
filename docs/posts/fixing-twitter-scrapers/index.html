<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Getting New Hobby and Fixing My Twitter Scrapers | Ahmad Alkadri</title>
<meta name="keywords" content="">
<meta name="description" content="Or how I finally decided to stop procrastinating and just simply fix my own old Python module to scrape tweets and generating wordcloud from it.">
<meta name="author" content="">
<link rel="canonical" href="/posts/fixing-twitter-scrapers/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.ce308c09b4317de5915a254af8d25c3549129148eb8584d37d76782e901c8f27.css" integrity="sha256-zjCMCbQxfeWRWiVK&#43;NJcNUkSkUjrhYTTfXZ4LpAcjyc=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Getting New Hobby and Fixing My Twitter Scrapers" />
<meta property="og:description" content="Or how I finally decided to stop procrastinating and just simply fix my own old Python module to scrape tweets and generating wordcloud from it." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/fixing-twitter-scrapers/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-16T23:17:14+02:00" />
<meta property="article:modified_time" content="2023-06-16T23:17:14+02:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Getting New Hobby and Fixing My Twitter Scrapers"/>
<meta name="twitter:description" content="Or how I finally decided to stop procrastinating and just simply fix my own old Python module to scrape tweets and generating wordcloud from it."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "/posts/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Getting New Hobby and Fixing My Twitter Scrapers",
      "item": "/posts/fixing-twitter-scrapers/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Getting New Hobby and Fixing My Twitter Scrapers",
  "name": "Getting New Hobby and Fixing My Twitter Scrapers",
  "description": "Or how I finally decided to stop procrastinating and just simply fix my own old Python module to scrape tweets and generating wordcloud from it.",
  "keywords": [
    
  ],
  "articleBody": "Weekend, finally! Past weeks have been so intense both at work and home. It feels good being able to finally breathe a little bit. I hope everybody who’s reading this are having great time!\nSpeaking of great time, honestly, there used to be such time period in my life where weekends mean full days on the road, traveling, visiting quiet picturesque villages in Southern France with my wife. Or perhaps go to a bookstore to find some new Murakami books. Or maybe visit that café that looks so cozy, enjoying matcha or a bit of Boba tea.\nWell, those days are gone. Lately weekends are filled more with staying at home, resting ourselves after full week of work, watching TV, and maybe reading a little bit. Basically cozying up. Some friends told me it’s called “getting old”, and at this point, maybe I should be agreeing with him.\nNew Hobby and Tweet Cloud Maker On the other hand, I also picked up a new hobby since couple months ago. That is learning game development. It’s still a bit too early for me to show anything, I’ve been doing basically nothing except following a lot of tutorials on YouTube to get hands-on learning (note: if you’re learning Pygame and looking for some excellent tutorials, I would recommend this channel called Clear Code wholeheartedly. Hands down the best Pygame tutorials I’ve ever seen. Practically teaching me about game dev workflow from zero). Nevertheless, I really aim to create my own game one day–maybe I should blog about it more later.\nAnyway, this blog shouldn’t be about my painful but so far satisfying process of learning game development. Not really. What happened was that about one or two weeks ago, while I was tidying up my github repo a little bit (so many abandoned weekend projects, gosh), I suddenly found my old Tweet Cloud Maker repo again. It was archived, and I remember that it was archived because, after some changes in Twitter API (I believe it was some time early this year), the snscrape module–the primary module that I used to scrape tweets from Twitter–stopped working for me.\nI remember myself not having too much time back then, and decided to take it down, promising myself to fix it one day.\nWell I unarchived the repo and started working on it again. Immediately, I still found myself having the primary module not working for me. I opened up their repo, browsing for their Issues and started reading, and basically got stopped at the following phrase on their README:\nIt is also possible to use snscrape as a library in Python, but this is currently undocumented.\nThat was kind of unfortunate. I was thinking of probably being a contributor to the repo, study it and write some documentations while trying to find out the issue for me, when I realized that it would take a bit more time and that it’d probably be faster for me to fix my old twitter scraping module and use it for this app.\nEnter the pytterrator Sometime around early last year, I started getting more conscious about privacy. I tried to make some efforts to stop using many apps that soak my data consistently. I stopped using most of my social media and finally deleting it one by one (privacy’s not the only reason, but it plays a big role in my decision; I’ll probably write a blog about it later). I don’t really like the idea of companies I don’t know using my data for profit without my full informed consent.\nI started looking for alternatives for using many of web services I’ve been using for a long time: Invidious for YouTube, SearxNG to replace Google, etc. One of the social media that I used consistently for searching up news around the world quickly is Twitter, and I stumbled upon Nitter, an alternative Twitter frontend that works with more or less the same principles as Invidious and SearxNG: get the data from the official site using API, strip away all the trackers, and display them in a cleaner, faster interface.\nI like it. It’s lightweight, I don’t have to install any applications to find out what Elon Musk is tweeting for example. I liked it a lot that I decided to start a weekend project back then called pytterrator that, I imagine, would become a simple Python module allowing us to get tweets using Twitter’s API and some scraping (if necessary), one that I’d be able to use as a foundation for making a full webapp just like Nitter.\nWhat Happened? Nothing. Long story short lots of things fell upon my lap in 2022 at work. I somehow got promoted. I got new responsibilities. The project gathered dust for months, and in the few moments I got to return to it, I couldn’t manage to do anything significant. Couple that with the changes in Twitter’s API, I thought to myself that I wouldn’t be able to fix and develop it further (or even taking care of my other side-projects) without having to sacrifice my career and sanity.\nThat kinda changed now. With the company expanding and developing, and more and more automated systems are put in place, I found my works to be much more streammlined and easy to manage lately. It feels good knowing that the company is slowly maturing, no longer a tiny startup comprising of five engineers working together in a single office. Everything started to fall into a more disciplined, consistent and well-structured routines, and I found myself having more time for my own projects (hence starting the game devs hobby lol).\nTo cut the story short: I opened up again the pytterrator repo and managed to make it work. It’s still so raw, no documentations yet put in place (I’ll definitely prepare it soon, promise), but it works to scrape tweets from public account. It uses Twitter v1.1 API, it puts some limiters to itself, it can regenerate guest token if needed. So far, it just works.\n(If you somehow trying it out and found some bugs on it please raise them as Issues or if you want you can help contribute directly! Would be really appreciated!)\nBack to Tweet Cloud Maker So that was four days ago. Then I came back to the more pressing problematic app of mine that is my Tweet Cloud Maker app. I decided to switch fully from the snscrape module to pytterrator.\nThe process wasn’t difficult at all. The scraper functions were simply removed and replaced by the methods defined in the pytterrator’s Client class. That alone managed to make the app up and running. It can scrape tweets up to certain number limit that we request (though I still put a limit of 1000 tweets–this could potentially change in the future after I experiment and develop more on the module to handle the rate limit). The tweets are then digested, words containing special characters were removed.\nThen, as a bigger change, I simply remove the feature to scrape tweets between certain dates. The reason is simple: for now I haven’t implement the method to do this yet on pytterrator properly. Once I manage to do that on the module, I’ll simply update the module used in Tweet Cloud Maker and implement this new feature!\nResults Some screenshots of the app running:\nLanding page Scraping Elon Musk’s tweets There are still some works that I’d like to do though. I’d like for it to be able to recognize Chinese, Japanese, and Korean character for example. I’ve initiated this work on the app but it’s far from done. Unlike alphabetic sentences, words in Japanese or Chinese are seldom divided by spaces. Korean sentences do this but some parts still poorly recognized by the app. Stopwords or special characters are also need to be handled differently. This is definitely one of the stuffs that I’ll work on in the future, together with the date/calendar-based scraping.\nCurrently, it’s up and running and available on its old address at Streamlit Cloud: tweetcloudmaker.streamlit.app. If you want to try it out, please go ahead! If you want to clone it and run it locally on your machine, you’re also welcome! Found some bugs or problems? You’re welcome to open some Issues on the repo or comment here. I’ll try to get back to you as soon as I can!\nOnce again wishing everyone a nice weekend!\n",
  "wordCount" : "1405",
  "inLanguage": "en",
  "datePublished": "2023-06-16T23:17:14+02:00",
  "dateModified": "2023-06-16T23:17:14+02:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/posts/fixing-twitter-scrapers/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Ahmad Alkadri",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="Ahmad Alkadri (Alt + H)">Ahmad Alkadri</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="/page/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Getting New Hobby and Fixing My Twitter Scrapers
    </h1>
    <div class="post-description">
      Or how I finally decided to stop procrastinating and just simply fix my own old Python module to scrape tweets and generating wordcloud from it.
    </div>
    <div class="post-meta"><span title='2023-06-16 23:17:14 +0200 CEST'>Fri, Jun 16, 2023</span>

</div>
  </header> 
  <div class="post-content"><p>Weekend, finally! Past weeks have been so intense both at work and home. It feels good being able to finally breathe a little bit. I hope everybody who&rsquo;s reading this are having great time!</p>
<p>Speaking of great time, honestly, there used to be such time period in my life where weekends mean full days on the road, traveling, visiting quiet picturesque villages in Southern France with my wife. Or perhaps go to a bookstore to find some new Murakami books. Or maybe visit that café that looks so cozy, enjoying matcha or a bit of Boba tea.</p>
<p>Well, those days are gone. Lately weekends are filled more with staying at home, resting ourselves after full week of work, watching TV, and maybe reading a little bit. Basically cozying up. Some friends told me it&rsquo;s called &ldquo;getting old&rdquo;, and at this point, maybe I should be agreeing with him.</p>
<h2 id="new-hobby-and-tweet-cloud-maker">New Hobby and Tweet Cloud Maker<a hidden class="anchor" aria-hidden="true" href="#new-hobby-and-tweet-cloud-maker">#</a></h2>
<p>On the other hand, I also picked up a new hobby since couple months ago. That is learning game development. It&rsquo;s still a bit too early for me to show anything, I&rsquo;ve been doing basically nothing except following a lot of tutorials on YouTube to get hands-on learning (note: if you&rsquo;re learning Pygame and looking for some excellent tutorials, I would recommend this channel called <a href="https://www.youtube.com/@ClearCode">Clear Code</a> wholeheartedly. Hands down the best Pygame tutorials I&rsquo;ve ever seen. Practically teaching me about game dev workflow from zero). Nevertheless, I really aim to create my own game one day&ndash;maybe I should blog about it more later.</p>
<p>Anyway, this blog shouldn&rsquo;t be about my painful but so far satisfying process of learning game development. Not really. What happened was that about one or two weeks ago, while I was tidying up my github repo a little bit (so many abandoned weekend projects, <em>gosh</em>), I suddenly found my old Tweet Cloud Maker repo again. It was archived, and I remember that it was archived because, after some changes in Twitter API (I believe it was some time early this year), the <code>snscrape</code> module&ndash;the primary module that I used to scrape tweets from Twitter&ndash;stopped working for me.</p>
<p>I remember myself not having too much time back then, and decided to take it down, promising myself to fix it one day.</p>
<p>Well I unarchived the repo and started working on it again. Immediately, I still found myself having the primary module not working for me. I opened up their repo, browsing for their Issues and started reading, and basically got stopped at the following phrase on their <a href="https://github.com/JustAnotherArchivist/snscrape/blob/master/README.md">README</a>:</p>
<blockquote>
<p>It is also possible to use snscrape as a library in Python, but this is currently undocumented.</p>
</blockquote>
<p>That was kind of unfortunate. I was thinking of probably being a contributor to the repo, study it and write some documentations while trying to find out the issue for me, when I realized that it would take a bit more time and that it&rsquo;d probably be faster for me to fix my old twitter scraping module and use it for this app.</p>
<h2 id="enter-the-pytterrator">Enter the <code>pytterrator</code><a hidden class="anchor" aria-hidden="true" href="#enter-the-pytterrator">#</a></h2>
<p>Sometime around early last year, I started getting more conscious about privacy. I tried to make some efforts to stop using many apps that soak my data consistently. I stopped using most of my social media and finally deleting it one by one (privacy&rsquo;s not the only reason, but it plays a big role in my decision; I&rsquo;ll probably write a blog about it later). I don&rsquo;t really like the idea of companies I don&rsquo;t know using my data for profit without my full informed consent.</p>
<p>I started looking for alternatives for using many of web services I&rsquo;ve been using for a long time: <a href="https://invidious.io/">Invidious</a> for YouTube, <a href="https://docs.searxng.org/">SearxNG</a> to replace Google, etc. One of the social media that I used consistently for searching up news around the world quickly is Twitter, and I stumbled upon <a href="https://github.com/zedeus/nitter">Nitter</a>, an alternative Twitter frontend that works with more or less the same principles as Invidious and SearxNG: get the data from the official site using API, strip away all the trackers, and display them in a cleaner, faster interface.</p>
<p>I like it. It&rsquo;s lightweight, I don&rsquo;t have to install any applications to find out what Elon Musk is tweeting for example. I liked it a lot that I decided to start a weekend project back then called <a href="https://github.com/ahmad-alkadri/pytterrator"><code>pytterrator</code></a> that, I imagine, would become a simple Python module allowing us to get tweets using Twitter&rsquo;s API and some scraping (if necessary), one that I&rsquo;d be able to use as a foundation for making a full webapp just like Nitter.</p>
<h2 id="what-happened">What Happened?<a hidden class="anchor" aria-hidden="true" href="#what-happened">#</a></h2>
<p>Nothing. Long story short lots of things fell upon my lap in 2022 at work. I somehow got promoted. I got new responsibilities. The project gathered dust for months, and in the few moments I got to return to it, I couldn&rsquo;t manage to do anything significant. Couple that with the changes in Twitter&rsquo;s API, I thought to myself that I wouldn&rsquo;t be able to fix and develop it further (or even taking care of my other side-projects) without having to sacrifice my career and sanity.</p>
<p>That kinda changed now. With <a href="https://www.lekolabs.com/news">the company</a> expanding and developing, and more and more automated systems are put in place, I found my works to be much more streammlined and easy to manage lately. It feels good knowing that the company is slowly maturing, no longer a tiny startup comprising of five engineers working together in a single office. Everything started to fall into a more disciplined, consistent and well-structured routines, and I found myself having more time for my own projects (hence starting the game devs hobby lol).</p>
<p>To cut the story short: I opened up again the <code>pytterrator</code> repo and <a href="https://github.com/ahmad-alkadri/pytterrator/pull/4">managed to make it work</a>. It&rsquo;s still so raw, no documentations yet put in place (I&rsquo;ll definitely prepare it soon, promise), but it works to scrape tweets from public account. It uses Twitter v1.1 API, it puts some limiters to itself, it can regenerate guest token if needed. So far, it just works.</p>
<p>(If you somehow trying it out and found some bugs on it please raise them as Issues or if you want you can help contribute directly! Would be really appreciated!)</p>
<h2 id="back-to-tweet-cloud-maker">Back to Tweet Cloud Maker<a hidden class="anchor" aria-hidden="true" href="#back-to-tweet-cloud-maker">#</a></h2>
<p>So that was four days ago. Then I came back to the more pressing problematic app of mine that is my Tweet Cloud Maker app. I decided to switch fully from the <code>snscrape</code> module to <code>pytterrator</code>.</p>
<p>The process wasn&rsquo;t difficult at all. The scraper functions were simply removed and replaced by the methods defined in the <code>pytterrator</code>&rsquo;s Client class. That alone managed to make the app up and running. It can scrape tweets up to certain number limit that we request (though I still put a limit of 1000 tweets&ndash;this could potentially change in the future after I experiment and develop more on the module to handle the rate limit). The tweets are then digested, words containing special characters were removed.</p>
<p>Then, as a bigger change, I simply remove the feature to scrape tweets between certain dates. The reason is simple: for now I haven&rsquo;t implement the method to do this yet on <code>pytterrator</code> properly. Once I manage to do that on the module, I&rsquo;ll simply update the module used in Tweet Cloud Maker and implement this new feature!</p>
<h2 id="results">Results<a hidden class="anchor" aria-hidden="true" href="#results">#</a></h2>
<p>Some screenshots of the app running:</p>
<table>
<thead>
<tr>
<th><img loading="lazy" src="/assets/img/fixing-twitter-scrapers/ss_1.png" alt=""  />
</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>Landing page</em></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><img loading="lazy" src="/assets/img/fixing-twitter-scrapers/ss_2.png" alt=""  />
</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>Scraping Elon Musk&rsquo;s tweets</em></td>
</tr>
</tbody>
</table>
<p>There are still some works that I&rsquo;d like to do though. I&rsquo;d like for it to be able to recognize Chinese, Japanese, and Korean character for example. I&rsquo;ve initiated this work on the app but it&rsquo;s far from done. Unlike alphabetic sentences, words in Japanese or Chinese are seldom divided by spaces. Korean sentences do this but some parts still poorly recognized by the app. Stopwords or special characters are also need to be handled differently. This is definitely one of the stuffs that I&rsquo;ll work on in the future, together with the date/calendar-based scraping.</p>
<p>Currently, it&rsquo;s up and running and available on its old address at Streamlit Cloud: <a href="https://tweetcloudmaker.streamlit.app">tweetcloudmaker.streamlit.app</a>. If you want to try it out, please go ahead! If you want to clone it and run it locally on your machine, you&rsquo;re also welcome! Found some bugs or problems? You&rsquo;re welcome to open some Issues on the repo or comment here. I&rsquo;ll try to get back to you as soon as I can!</p>
<p>Once again wishing everyone a nice weekend!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>

  <div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
      
      
      if (window.location.hostname == "localhost")
                return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'ahmad-alkadri';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="/">Ahmad Alkadri</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
